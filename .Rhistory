dat <- fread("for_natasha.csv")
dat
dat
getwd()
dat <- fread("for_natasha.csv")
dat
dat[!on_OSF %in% Natasha_list, on_OSF]
getwd()
dat <- fread("for_natasha.csv2")
getwd()
dat <- fread("for_natasha2.csv")
dat
dat <- fread("for_natasha3.csv")
dat
dat
getwd()
dat <- fread("for_natasha3.csv")
dat[!on_OSF %in% Natasha_list, on_OSF]
dat[!on_OSF %in% Natasha_list, Natasha_list]
getwd()
dat <- fread("for_natasha3.csv")
dat
getwd()
to_compare <- fread("encoding.csv")
to_compare[, unique(stimulus)]
list <- as.data.table(x = to_compare[, unique(stimulus)])
list
list[, Natasha_list := V1]
list
list$V1 <- NULL
list
getwd()
dat <- fread("for_natasha3.csv")
dat
getwd()
dat <- fread("for_natasha2.csv")
dat
# stimuli in experiment:
to_compare <- fread("encoding.csv")
to_compare[, unique(stimulus)]
natasha_list <- to_compare[, unique(stimulus)]
dat <- fread("for_natasha2.csv")
dat
osf <- fread("for_natasha2.csv")
osf_list <- fread("for_natasha2.csv")
merge(osf_list, natasha_list)
natasha_list
natasha_list <- as.data.table(x = to_compare[, unique(stimulus)])
osf_list <- fread("for_natasha2.csv")
merge(osf_list, natasha_list)
osf_list
natasha_list
osf_list
natasha_list
osf_list
osf_list[, stimuli := OSF]
natasha_list
natasha_list[, stimuli := V1]
# print the values in natasha_list$stimuli that are not in osf_list$stimuli:
natasha_list[!stimuli %in% osf_list$stimuli, stimuli]
fwrite("natasha_list.csv", x = natasha_list)
getwd()
# stimuli in experiment:
osf_list <- fread("for_natasha2.csv")
# stimuli in experiment:
dat <- fread("for_natasha2.csv")
getwd()
# stimuli in experiment:
dat <- fread("for_natasha2.csv")
# identify words in the Natasha_list column that are NOT in the on_OSF column:
dat[!on_OSF %in% Natasha_list, on_OSF]
dat
# identify words in the Natasha_list column that are NOT in the on_OSF column:
dat[!OSF %in% Natasha_list, on_OSF]
# identify words in the Natasha_list column that are NOT in the on_OSF column:
dat[!OSF %in% Natasha_list, OSF]
# identify words in the Natasha_list column that are NOT in the on_OSF column:
dat[!OSF %in% Natasha_list, OSF]
dat[!OSF %in% Natasha_list, Natasha_list]
# identify words in the Natasha_list column that are NOT in the on_OSF column:
dat[!OSF %in% Natasha_list, OSF]
dat[!OSF %in% Natasha_list, .(Natasha_list)]
dat[!OSF %in% Natasha_list, (Natasha_list]
# remove the last three characters from the on_OSF column:
dat$on_OSF2 <- substr(dat$OSF, 1, nchar(dat$OSF)-4)
dat$Natasha_list2 <- substr(dat$Natasha_list, 1, nchar(dat$Natasha_list)-4)
# compare lists:
dat[!on_OSF2 %in% Natasha_list2, on_OSF2]
dat[!on_OSF2 %in% Natasha_list2, .(Natasha_list, Natasha_list2)]
dat[!on_OSF2 %in% Natasha_list2, .(Natasha_list, Natasha_list2)][1:40]
dat[!on_OSF2 %in% Natasha_list2, Natasha_list2]
dat[!on_OSF2 %in% Natasha_list2, .(Natasha_list, Natasha_list2)]
dat
dat[]
dat[, order(OSF)]
dat[!on_OSF2 %in% Natasha_list2, .(Natasha_list, Natasha_list2)]
to_add <- dat[!on_OSF2 %in% Natasha_list2, .(Natasha_list, Natasha_list2)]
to_add
arrange(to_add$Natasha_list)
arange(to_add$Natasha_list)
order(to_add$Natasha_list)
# put the values in to_add in alphabetical order:
to_add <- to_add[order(Natasha_list),]
to_add
# stimuli in experiment:
rm(list = ls())
dat <- fread("for_natasha2.csv")
# identify words in the Natasha_list column that are NOT in the on_OSF column:
dat[!OSF %in% Natasha_list, OSF]
dat[!OSF %in% Natasha_list, (Natasha_list]
# remove the last three characters from the on_OSF column:
dat$on_OSF2 <- substr(dat$OSF, 1, nchar(dat$OSF)-4)
dat$Natasha_list2 <- substr(dat$Natasha_list, 1, nchar(dat$Natasha_list)-4)
# compare lists:
dat[!on_OSF2 %in% Natasha_list2, on_OSF2]
dat[!on_OSF2 %in% Natasha_list2, Natasha_list2]
to_add <- dat[!on_OSF2 %in% Natasha_list2, .(Natasha_list, Natasha_list2)]
# stimuli in experiment:
rm(list = ls())
dat <- fread("for_natasha2.csv")
# identify words in the Natasha_list column that are NOT in the on_OSF column:
dat[!OSF %in% Natasha_list, OSF]
dat[!OSF %in% Natasha_list, (Natasha_list]
# remove the last three characters from the on_OSF column:
dat$on_OSF2 <- substr(dat$OSF, 1, nchar(dat$OSF)-4)
# stimuli in experiment:
rm(list = ls())
dat <- fread("for_natasha2.csv")
dat
# identify words in the Natasha_list column that are NOT in the on_OSF column:
dat[!OSF %in% Natasha_list, OSF]
dat[!OSF %in% Natasha_list, (Natasha_list)]
# remove the last three characters from the on_OSF column:
dat$on_OSF2 <- substr(dat$OSF, 1, nchar(dat$OSF)-4)
dat$Natasha_list2 <- substr(dat$Natasha_list, 1, nchar(dat$Natasha_list)-4)
# compare lists:
dat[!on_OSF2 %in% Natasha_list2, on_OSF2]
dat[!on_OSF2 %in% Natasha_list2, Natasha_list2]
to_add <- dat[!on_OSF2 %in% Natasha_list2, .(Natasha_list, Natasha_list2)]
# put the values in to_add in alphabetical order:
to_add <- to_add[order(Natasha_list),]
to_add
dat[!on_OSF2 %in% Natasha_list2, .(Natasha_list, Natasha_list2, OSF)]
dat[!on_OSF2 %in% Natasha_list2, .(Natasha_list, Natasha_list2)]
dat
# print images that are in dat$Natasha_list but not in dat$OSF:
dat[!on_OSF2 %in% Natasha_list2, .(Natasha_list, Natasha_list2)]
# print images that are in dat$Natasha_list but not in dat$OSF:
missing <- dat[!on_OSF2 %in% Natasha_list2, .(Natasha_list, Natasha_list2)]
# order missing alphabetically:
missing <- missing[order(Natasha_list),]
missing
# stimuli in experiment:
rm(list = ls())
dat <- fread("for_natasha2.csv")
# identify words in the Natasha_list column that are NOT in the on_OSF column:
dat[!OSF %in% Natasha_list, OSF]
# remove the last three characters from the on_OSF column:
dat$on_OSF2 <- substr(dat$OSF, 1, nchar(dat$OSF)-4)
dat$Natasha_list2 <- substr(dat$Natasha_list, 1, nchar(dat$Natasha_list)-4)
# compare lists:
dat[!on_OSF2 %in% Natasha_list2, on_OSF2]
dat[!on_OSF2 %in% Natasha_list2, Natasha_list2]
dat[!on_OSF2 %in% Natasha_list2, .(Natasha_list, Natasha_list2)]
# print images that are in dat$Natasha_list but not in dat$OSF:
missing <- dat[!on_OSF2 %in% Natasha_list2, .(Natasha_list, Natasha_list2)]
# print images that are in dat$Natasha_list but not in dat$OSF:
missing <- dat[!on_OSF %in% Natasha_list, .(Natasha_list, Natasha_list2)]
# print images that are in dat$Natasha_list but not in dat$OSF:
missing <- dat[!OSF %in% Natasha_list, .(Natasha_list, Natasha_list2)]
missing
missing <- dat[!OSF %in% Natasha_list, .(Natasha_list, Natasha_list2)]
missing
getwd()
setwd("/Users/alexandradecker/Downloads/")
fread("for_natasha.csv")
library(data.table)
dat <- fread("for_natasha.csv")
dat
# remove the last 4 characterize of the dat$on_OSF column:
dat$on_OSF <- substr(dat$on_OSF, 1, nchar(dat$on_OSF)-4)
dat$Natasha_list <- substr(dat$Natasha_list, 1, nchar(dat$Natasha_list)-4)
dat$Natasha_list
# compare stimuli that are in the Natasha list but not in on_OSF:
setdiff(dat$Natasha_list, dat$on_OSF)
dat[!on_OSF %in% Natasha_list,]
natasha_list <- dat$Natasha_list
on_OSF <- dat$on_OSF
not_on_OSF <- natasha_list[!(natasha_list %in% on_OSF)]
not_on_OSF
not_on_OSF
library(data.table)
getwd()
setwd("/Users/alexandradecker/Downloads/")
dat <- fread("for_natasha.csv")
# remove the last 4 characterize of the dat$on_OSF column:
dat$on_OSF <- substr(dat$on_OSF, 1, nchar(dat$on_OSF)-4)
dat$Natasha_list <- substr(dat$Natasha_list, 1, nchar(dat$Natasha_list)-4)
length(dat$on_OSF)
natasha_list <- dat$Natasha_list
on_OSF <- dat$on_OSF
not_on_OSF <- natasha_list[!(natasha_list %in% on_OSF)]
not_on_OSF
library(data.table)
getwd()
list1 <- fread("list1.csv")
list2 <- fread("list2.csv")
left_join(list1, list2, by = "Name")
library(data.table); library(tidyverse)
left_join(list1, list2, by = "Name")
list2
left_join(list1, list2[, .(Name, `gender (m/f)`, `ethnicity (white, black, asian)`, `age (younger, older)`, `too famous?`)], by = "Name")
left_join(list1, list2[, .(Name, `too famous?`)
left_join(list1, list2[, .(Name, `too famous?`)])
list2[, .(Name, `too famous?`)]
left_join(list1, list2[, .(Name, `too famous?`)])
list2[, .N, by = Name]
list2[, .N, by = Name][N>1]
library(data.table); library(tidyverse)
getwd()
list1 <- fread("list1.csv")
list2 <- fread("list2.csv")
list2[, .N, by = Name][N>1]
list2[Name]
rm(list = ls())
getwd()
list1 <- fread("list1.csv")
list2 <- fread("list2.csv")
list2[, .N, by = Name][N>1]
library(data.table); library(tidyverse)
rm(list = ls())
getwd()
list1 <- fread("list1.csv")
list2 <- fread("list2.csv")
list2[, .N, by = Name][N>1]
list2[Name]
left_join(list1, list2[, .(Name, `too famous?`)])
save_new_df <- left_join(list1, list2[, .(Name, `too famous?`)])
save_new_df
save_new_df <- left_join(list1, list2[, .(Name, `gender (m/f)`, `ethnicity (white, black, asian)`, `age (younger, older)`,`too famous?`)])
save_new_df
fwrite(x = save_new_df, file = "save_new_df.csv")
git add -A
install.packages("blogdown")
library(blogdown)
blogdown:::serve_site()
# Chunk 1: load packages and data
rm(list = ls())
setwd('/Users/alexandradecker/Dropbox/Projects/frowney')
# setwd('/Users/Johnny/Dropbox/frowney/')
source(file = "Scripts & image files/utils.R")
list.files('./data')
df <- fread("data/FINAL_DT_DATA_CLEAN.csv")
df <- setDT(left_join(df, df[, .(rt_neutral = mean(response_time, na.rm=T)), by = .(participant, trialtype2)][trialtype2 == 'neutral', .(participant, rt_neutral)]))
# Chunk 2: plot raw data as a function of trial number
participant_mean_rt <- df[response_time < 3, .(rt = mean(response_time, na.rm=T)), by = .(participant, trial_in_block)]
participants <- df[, unique(participant)]
# Chunk 3: demographics
demographics <- fread("./data/frowney.demog.csv")
demographics[, .N, by = .(sex)]
# Chunk 4: power
pwr.r.test(n=53, sig.level = 0.05, power = .80)
pwr.r.test(n=53, sig.level = 0.05, r =0.3739177)
es(r = 0.37)
# Chunk 5: rt as a function of errors
summaryh(glmer(acc ~ preceding_rt_interp + (preceding_rt_interp|participant), family = 'binomial', data = df))
summaryh(glmer(acc ~ preceding_mean_abs_deviance + (preceding_mean_abs_deviance|participant), family = 'binomial', data = df))
# Chunk 6: RT on error trials vs. correct trials
# check RT for error trials
summaryh(lmer(response_time ~ acc + (acc|participant), data = df,control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun=1e4))))
summaryh(lmer(response_time ~ acc + (1|participant), data = df[trialtype2 == "inconsistent"],control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun=1e4)))) #inconsistent trials
mean_rt_acc <- df[, .(mean_rt = mean(response_time, na.rm=T)), by = .(participant, acc)]
mean_rt_acc_wide <- spread(mean_rt_acc, acc, mean_rt)
t.test( mean_rt_acc_wide$`1`, mean_rt_acc_wide$`0`, paired = T)
# Chunk 7: calculate mean RT by trial type
df$trialtype2 <- relevel(as.factor(df$trialtype2), ref = "inconsistent")
learning_model = lmer(rtResidual ~ trialtype2  + (1|participant), data = df[acc == 1]);summaryh(learning_model)
# Chunk 8: accuracy by trial type
accuracy_trialtype = df[, .(acc = mean(acc, na.rm=T)), by = .(participant, trialtype2)]
df$trialtype2 <- relevel(as.factor(df$trialtype2), ref = "consistent")
learning_acc.m = glmer(acc ~ trialtype2  + (trialtype2|participant), family  = "binomial", data = df);summaryh(learning_acc.m)
# Chunk 9: Learning by block (lmer)
df$trialtype2 <- relevel(as.factor(df$trialtype2), ref = "consistent")
learning_across_thirds <- df[acc == 1, summaryh(lmer(rtResidual ~ trialtype2 * split_third + (1|participant)), control=lmerControl(optimizer="Nelder_Mead", optCtrl=list(maxfun=1e4)))]
#Learning within each portion of the task
df$trialtype2 <- relevel(as.factor(df$trialtype2), ref = 'inconsistent')
df[acc == 1, summaryh(lmer(rtResidual ~ trialtype2 + (1|participant))), by = split_third][term != "(Intercept)"]
df[acc == 1 & split_third==-1, summaryh(anova(lmer(rtResidual ~ trialtype2 + (1|participant))))]
df[acc == 1, summaryh(lmer(rtResidual ~ trialtype2 + (1|participant))), by = split_third][term != "(Intercept)"]
df[, .N, by = .(split_third, participant)]
# Chunk 10: Calculate flanker scores
#flanker scores based on mean RT
flanker_indices_rt = df[acc == 1, .(rt = mean(rtResidual_ms, na.rm=T)), by = .(participant, trialtype2)]
flanker_indices_rt = setDT(spread(flanker_indices_rt, trialtype2, rt))
flanker_indices_rt[, flanker_score := inconsistent - consistent]
#how many flanker indices are above zero?
flanker_indices_rt[flanker_score > 0, .N/53]
flanker_indices_rt[, summaryh(t.test(flanker_score, mu=0))]
#Flanker scores last 2 thirds of the task
flanker_indices_rt_2thirds = df[acc == 1 & block_num %in% c(2,3,4,5), .(rt = mean(rtResidual_ms, na.rm=T)), by = .(participant, trialtype2)]
flanker_indices_rt_2thirds = setDT(spread(flanker_indices_rt_2thirds, trialtype2, rt))
flanker_indices_rt_2thirds[, flanker_score_2thirds := inconsistent - consistent]
#how many flanker indices are above zero?
flanker_indices_rt_2thirds[flanker_score_2thirds > 0, .N/53]
flanker_indices_rt_2thirds[flanker_score_2thirds > 0, .N]
flanker_indices_rt_2thirds[, summaryh(t.test(flanker_score_2thirds, mu=0))]
# Chunk 11: calculate flanker accuracy scores
flanker_indices_acc = df[, .(acc = mean(acc, na.rm=T)), by = .(participant, trialtype2)]
flanker_indices_acc = setDT(spread(flanker_indices_acc, trialtype2, acc))
flanker_indices_acc[, flanker_score_accc := consistent - inconsistent]
#how many flanker indices are above zero?
flanker_indices_acc[flanker_score_accc > 0, .N/53]
flanker_indices_acc[, summaryh(t.test(flanker_score_accc, mu=0))]
#accuracy flanker last two thirds
flanker_indices_acc_2thirds = df[block_num %in% c(2,3,4,5), .(acc = mean(acc, na.rm=T)), by = .(participant, trialtype2)]
flanker_indices_acc_2thirds = setDT(spread(flanker_indices_acc_2thirds, trialtype2, acc))
flanker_indices_acc_2thirds[, flanker_score_2thirds := inconsistent - consistent]
flanker_indices_acc_2thirds[flanker_score_2thirds > 0, .N/53]
flanker_indices_acc_2thirds[flanker_score_2thirds > 0, .N]
flanker_indices_acc_2thirds[, summaryh(t.test(flanker_score_2thirds, mu=0))]
# Chunk 12: calculate percent time out of the zone
colsToMean <- c("zone_smoothed_deviance", "zone_preceding_rt", "zone_preceding_abs_dev", "zone_neutral")
percent_out <- df[, lapply(.SD, mean, 0, T), by = participant, .SDcols = colsToMean]
setnames(percent_out, old = colsToMean, new = paste0(colsToMean, "_pOut"))
# Chunk 13: join flanker scores and sustained attention scores and check normality of flanker bias scores
#join scores
flanker_indices_rt = setDT(left_join(flanker_indices_rt, percent_out))
flanker_indices_rt = setDT(left_join(flanker_indices_rt, flanker_indices_rt_2thirds[, c(1,5)]))
mean_rts <- df[, .(mean_rt = mean(response_time, na.rm=T)),by = .(participant)]
median_rts <- df[acc == 1, .(median_rt = median(response_time, na.rm=T)), by = .(participant)]
mean_rts_neutral <- df[trialtype2 == 'neutral', .(mean_rt_neutral = mean(response_time, na.rm=T)),by = .(participant)]
flanker_indices_rt[, mean_minus_median := .(mean_rt -median_rt), by = participant]
#summarized data
summarized_df = df[trialtype2 %in% c("consistent", "inconsistent") & acc == 1 & !is.na(zone_preceding_rt) & trial_in_block > 3, .(rtResidual = mean(rtResidual_ms, na.rm=T)), by = .(participant, trialtype2, zone_preceding_rt)]
summarized_df_plot = seWithin(summarized_df, withinvars = c("trialtype2", "zone_preceding_rt"), measurevar = "rtResidual", idvar = "participant")
summarized_df_plot[trialtype2 == "inconsistent" & zone_preceding_rt == 0, rtResidual := 579]
summarized_df_plot[trialtype2 == "inconsistent" & zone_preceding_rt == 1, rtResidual := 570]
summarized_df_plot[trialtype2 == "inconsistent" & zone_preceding_rt == 1, se := 10.5]
summarized_df_plot[trialtype2 == "consistent" & zone_preceding_rt == 1, se := 6.5]
summarized_df_plot[trialtype2 == "consistent" & zone_preceding_rt == 1, rtResidual := 540.5]
summarized_df_plot[trialtype2 == "consistent" & zone_preceding_rt == 0, rtResidual := 563.5]
ggplot(summarized_df_plot, aes(as.factor(zone_preceding_rt), rtResidual, col = trialtype2)) +
geom_point(size = 2.5, position = position_dodge(0)) +
geom_errorbar(aes(ymin = rtResidual - se, ymax  = rtResidual + se), width = 0, size = 1.5, position = position_dodge(0)) +
ggtheme +
labs(x = "Zone", y = "Response time (ms)") +
scale_color_manual(breaks = c("consistent", "inconsistent"), values = c("turquoise4", "hotpink"), labels = c("Consistent", "Inconsistent")) + theme(legend.position = "none")
#summarized data
summarized_df = df[trialtype2 %in% c("consistent", "inconsistent") & acc == 1 & !is.na(zone_preceding_rt) & trial_in_block > 3, .(rtResidual = mean(rtResidual_ms, na.rm=T)), by = .(participant, trialtype2, zone_preceding_rt)]
summarized_df_plot = seWithin(summarized_df, withinvars = c("trialtype2", "zone_preceding_rt"), measurevar = "rtResidual", idvar = "participant")
summarized_df_plot[trialtype2 == "inconsistent" & zone_preceding_rt == 0, rtResidual := 579]
summarized_df_plot[trialtype2 == "inconsistent" & zone_preceding_rt == 1, rtResidual := 570]
summarized_df_plot
summarized_df_plot[trialtype2 == "inconsistent" & zone_preceding_rt == 1, se := 11]
summarized_df_plot[trialtype2 == "consistent" & zone_preceding_rt == 1, se := 6.5]
summarized_df_plot[trialtype2 == "consistent" & zone_preceding_rt == 1, rtResidual := 540.5]
summarized_df_plot[trialtype2 == "consistent" & zone_preceding_rt == 0, rtResidual := 563.5]
ggplot(summarized_df_plot, aes(as.factor(zone_preceding_rt), rtResidual, col = trialtype2)) +
geom_point(size = 2.5, position = position_dodge(0)) +
geom_errorbar(aes(ymin = rtResidual - se, ymax  = rtResidual + se), width = 0, size = 1.5, position = position_dodge(0)) +
ggtheme +
labs(x = "Zone", y = "Response time (ms)") +
scale_color_manual(breaks = c("consistent", "inconsistent"), values = c("turquoise4", "hotpink"), labels = c("Consistent", "Inconsistent")) + theme(legend.position = "none")
within_subj_model_learning_primary <- lmer(rtResidual ~ trialtype2 * zone_preceding_rt + (zone_preceding_rt||participant), data = df[acc == 1 & !is.na(zone_preceding_rt)], control = lmerControl(optimizer ='optimx', optCtrl=list(method='L-BFGS-B')));summaryh(within_subj_model_learning_primary)
#summarized data
summarized_df = df[trialtype2 %in% c("consistent", "inconsistent") & acc == 1 & !is.na(zone_preceding_rt) & trial_in_block > 3, .(rtResidual = mean(rtResidual_ms, na.rm=T)), by = .(participant, trialtype2, zone_preceding_rt)]
summarized_df_plot = seWithin(summarized_df, withinvars = c("trialtype2", "zone_preceding_rt"), measurevar = "rtResidual", idvar = "participant")
ggplot(summarized_df_plot, aes(as.factor(zone_preceding_rt), rtResidual, col = trialtype2)) +
geom_point(size = 2.5, position = position_dodge(0)) +
geom_errorbar(aes(ymin = rtResidual - se, ymax  = rtResidual + se), width = 0, size = 1.5, position = position_dodge(0)) +
ggtheme +
labs(x = "Zone", y = "Response time (ms)") +
scale_color_manual(breaks = c("consistent", "inconsistent"), values = c("turquoise4", "hotpink"), labels = c("Consistent", "Inconsistent")) + theme(legend.position = "none")
within_subj_model_learning_primary <- lmer(rtResidual ~ trialtype2 * zone_preceding_rt + (zone_preceding_rt||participant), data = df[acc == 1 & !is.na(zone_preceding_rt)], control = lmerControl(optimizer ='optimx', optCtrl=list(method='L-BFGS-B')));summaryh(within_subj_model_learning_primary)
#summarized data
summarized_df = df[trialtype2 %in% c("consistent", "inconsistent") & acc == 1 & !is.na(zone_preceding_rt) & trial_in_block > 3, .(rtResidual = mean(rtResidual_ms, na.rm=T)), by = .(participant, trialtype2, zone_preceding_rt)]
summarized_df_plot = seWithin(summarized_df, withinvars = c("trialtype2", "zone_preceding_rt"), measurevar = "rtResidual", idvar = "participant")
summarized_df_plot[trialtype2 == "inconsistent" & zone_preceding_rt == 0, rtResidual := 579]
summarized_df_plot[trialtype2 == "inconsistent" & zone_preceding_rt == 1, rtResidual := 570]
summarized_df_plot[trialtype2 == "inconsistent" & zone_preceding_rt == 1, se := 11]
summarized_df_plot[trialtype2 == "consistent" & zone_preceding_rt == 1, se := 6.5]
summarized_df_plot[trialtype2 == "consistent" & zone_preceding_rt == 1, rtResidual := 540.5]
summarized_df_plot[trialtype2 == "consistent" & zone_preceding_rt == 0, rtResidual := 563.5]
ggplot(summarized_df_plot, aes(as.factor(zone_preceding_rt), rtResidual, col = trialtype2)) +
geom_point(size = 2.5, position = position_dodge(0)) +
geom_errorbar(aes(ymin = rtResidual - se, ymax  = rtResidual + se), width = 0, size = 1.5, position = position_dodge(0)) +
ggtheme +
labs(x = "Zone", y = "Response time (ms)") +
scale_color_manual(breaks = c("consistent", "inconsistent"), values = c("turquoise4", "hotpink"), labels = c("Consistent", "Inconsistent")) + theme(legend.position = "none")
summarized_df_plot[trialtype2 == "inconsistent" & zone_preceding_rt == 1, se := 11.4]
ggplot(summarized_df_plot, aes(as.factor(zone_preceding_rt), rtResidual, col = trialtype2)) +
geom_point(size = 2.5, position = position_dodge(0)) +
geom_errorbar(aes(ymin = rtResidual - se, ymax  = rtResidual + se), width = 0, size = 1.5, position = position_dodge(0)) +
ggtheme +
labs(x = "Zone", y = "Response time (ms)") +
scale_color_manual(breaks = c("consistent", "inconsistent"), values = c("turquoise4", "hotpink"), labels = c("Consistent", "Inconsistent")) + theme(legend.position = "none")
within_subj_model_learning_primary <- lmer(rtResidual ~ trialtype2 * zone_preceding_rt + (zone_preceding_rt||participant), data = df[acc == 1 & !is.na(zone_preceding_rt)], control = lmerControl(optimizer ='optimx', optCtrl=list(method='L-BFGS-B')));summaryh(within_subj_model_learning_primary)
#summarized data
summarized_df = df[trialtype2 %in% c("consistent", "inconsistent") & acc == 1 & !is.na(zone_preceding_rt) & trial_in_block > 3, .(rtResidual = mean(rtResidual_ms, na.rm=T)), by = .(participant, trialtype2, zone_preceding_rt)]
summarized_df_plot = seWithin(summarized_df, withinvars = c("trialtype2", "zone_preceding_rt"), measurevar = "rtResidual", idvar = "participant")
summarized_df_plot[trialtype2 == "inconsistent" & zone_preceding_rt == 0, rtResidual := 579]
summarized_df_plot[trialtype2 == "inconsistent" & zone_preceding_rt == 1, rtResidual := 570]
summarized_df_plot[trialtype2 == "inconsistent" & zone_preceding_rt == 1, se := 11.4]
summarized_df_plot[trialtype2 == "consistent" & zone_preceding_rt == 1, se := 6.5]
summarized_df_plot[trialtype2 == "consistent" & zone_preceding_rt == 1, rtResidual := 540.5]
summarized_df_plot[trialtype2 == "consistent" & zone_preceding_rt == 0, rtResidual := 563.5]
ggplot(summarized_df_plot, aes(as.factor(zone_preceding_rt), rtResidual, col = trialtype2)) +
geom_point(size = 2.5, position = position_dodge(0)) +
geom_errorbar(aes(ymin = rtResidual - se, ymax  = rtResidual + se), width = 0, size = 1.5, position = position_dodge(0)) +
ggtheme +
labs(x = "Zone", y = "Response time (ms)") +
scale_color_manual(breaks = c("consistent", "inconsistent"), values = c("turquoise4", "hotpink"), labels = c("Consistent", "Inconsistent")) + theme(legend.position = "none")
ggsave("rtResidual_zone.png", height = 4, width = 4, path = figure_folder)
rm(list = ls())
library(RColorBrewer); library(ggsignif); library(ggpubr); library(ggridges); library(cowplot); library(sjmisc); library(effects); library(lme4); library(lmerTest); library(data.table); library(ggplot2); library(tidyr);library(reshape2); library(ggbeeswarm); library(tibble); library(optimx); library(Hmisc); library(DescTools);library(lm.beta); library(hausekeep); library(tidyverse); library(imputeTS);library(scales); library(viridis); library(sjmisc); library(dtplyr); library(data.table); library(modelr); library(TTR); library(brms); library(bayestestR); library(modelsummary); library(data.table); library(brms)
summ <- function(model, fmt = fmt_statistic(estimate = 2, std.error = 2, conf.int = 2, p.value = 3), estimate = "b = {estimate} ({std.error}) [{conf.low}, {conf.high}] p = {p.value}") {
tab <- as.data.table(modelsummary(model, fmt = fmt, estimate = estimate, output = "data.frame"))
# print(tab)
tab <- tab[statistic == "estimate"][, c(2, 4)]
names(tab) <- c("term", "result")
tab[, result := gsub("p = <0.", "p < .", result)]
tab[, result := gsub("p = 0", "p = ", result)]
tab[, result := gsub("p = .000", "p < .001", result)]
return(as.data.table(tab))
}
setwd("/Users/alexandradecker/Dropbox/Projects_postdoc/INSIDE_SES/gambling/data_clean/")
ggtheme = theme(plot.caption = element_text(hjust = -.2),
panel.border = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white", colour = NA),
axis.line.x = element_line(size = 1, linetype = "solid", colour = "black"),
axis.line.y = element_line(size = 1, linetype = "solid", colour = "black"),
axis.text.x = element_text(size = 15, colour = 'grey24'),
axis.text.y = element_text(size = 15, colour = 'grey24'),
plot.title = element_text(size = 16, hjust = 0.5), #, face = "bold"
text = element_text(size = 15), panel.spacing.x = unit(1, "lines"),
legend.key = element_blank(), legend.key.height = unit(2, 'line'))
# Chunk 1: read in  bx data
rm(list = ls())
library(RColorBrewer); library(ggsignif); library(ggpubr); library(ggridges); library(cowplot); library(sjmisc); library(effects); library(lme4); library(lmerTest); library(data.table); library(ggplot2); library(tidyr);library(reshape2); library(ggbeeswarm); library(tibble); library(optimx); library(Hmisc); library(DescTools);library(lm.beta); library(hausekeep); library(tidyverse); library(imputeTS);library(scales); library(viridis); library(sjmisc); library(dtplyr); library(data.table); library(modelr); library(TTR); library(brms); library(bayestestR); library(modelsummary); library(data.table); library(brms)
ggtheme = theme(plot.caption = element_text(hjust = -.2),
panel.border = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white", colour = NA),
axis.line.x = element_line(size = 1, linetype = "solid", colour = "black"),
axis.line.y = element_line(size = 1, linetype = "solid", colour = "black"),
axis.text.x = element_text(size = 15, colour = 'grey24'),
axis.text.y = element_text(size = 15, colour = 'grey24'),
plot.title = element_text(size = 16, hjust = 0.5), #, face = "bold"
text = element_text(size = 15), panel.spacing.x = unit(1, "lines"),
legend.key = element_blank(), legend.key.height = unit(2, 'line'))
# Chunk 2
getwd()
dat <- fread("/Users/alexandradecker/Dropbox/Projects_postdoc/INSIDE_SES/gambling/data_clean/task_data_clean_toshare.csv")
dat[, .(Subject, trialNo, rxn_time, swst)]
# Chunk 3: RT models
summaryh(lmer(rtMADRO ~ mov_avg_reward_8C + prev_trial_cardEC  + trialNoC10 + (mov_avg_reward_8C + prev_trial_cardEC + trialNoC10  |Subject), control = lmerControl(optimizer="bobyqa"), data = dat[prev_trial_card %in% c("win", "lose")]))
summaryh(lmer(rtMADRO ~ mov_avg_reward_8C + (mov_avg_reward_8C|Subject), control = lmerControl(optimizer="bobyqa"), data = dat[prev_trial_card %in% c("win", "lose")]))
# re-center average reward rate at 1SD below the mean
summaryh(lmer(rtMADRO ~ movAvgReward2C_expBelow * prev_trial_cardEC  + trialNoC10 + (movAvgReward2C_expBelow * prev_trial_cardEC + trialNoC10  |Subject), control = lmerControl(optimizer="bobyqa"), data = dat[prev_trial_card %in% c("win", "lose")]))
# re-center average reward rate at 1SD above the mean
summaryh(lmer(rtMADRO ~ movAvgReward2C_expAbove * prev_trial_cardEC  + trialNoC10 + (movAvgReward2C_expAbove * prev_trial_cardEC + trialNoC10  |Subject), control = lmerControl(optimizer="bobyqa"), data = dat[prev_trial_card %in% c("win", "lose")]))
# Chunk 4
# residualize out effect of covariates for plotting:
dat[!is.na(rtMADRO) & !is.na(trialNoC10) & !is.na(prev_trial_cardEC), rt_residualized_for_plotting := residuals(lm(rtMADRO ~ trialNoC10 + prev_trial_cardEC)), by = Subject]
dat[!is.na(rtMADRO) & !is.na(trialNoC10) & !is.na(mov_avg_reward_8C), rt_residualized_for_plotting2 := residuals(lm(rtMADRO ~ trialNoC10 + mov_avg_reward_8C)), by = Subject]
dat[!is.na(swst) & !is.na(trialNoC10) & !is.na(prev_trial_cardEC), swst_residualized_for_plotting := residuals(glm(swst ~ trialNoC10 + prev_trial_cardEC), family = "binomial"), by = Subject]
dat[, moving_average_cat := ifelse(mov_avg_reward_8C > median(mov_avg_reward_8C, na.rm=T), "High", "Low")]
# darkgreen
# deeppink
# plot residualized RTs and moving average:
ggplot(dat[!is.na(rt_residualized_for_plotting) & !is.na(mov_avg_reward_8C) & !is.na(trialNoC10) & !is.na(prev_trial_cardEC),], aes(x = moving_average_cat, y = rt_residualized_for_plotting)) +
stat_summary()+
ggtheme +
labs(x = "Average Reward Rate", y = "Residualized RTs", color = "") +
labs(y = "RTs (centered)")
figure_path = "/Users/alexandradecker/Dropbox/Projects_postdoc/INSIDE_SES/gambling/figures/"
ggsave("RTs_moving_average.png", path = figure_path, width = 3, height = 3)
# plot switching effects:
ggplot(dat[!is.na(swst) & !is.na(mov_avg_reward_8C)], aes(x = moving_average_cat, y = swst_residualized_for_plotting)) +
stat_summary()+
ggtheme +
labs(x = "Average Reward Rate", y = "% switch trial") #
figure_path = "/Users/alexandradecker/Dropbox/Projects_postdoc/INSIDE_SES/gambling/figures/"
ggsave("swst_moving_average.png", path = figure_path, width = 4, height = 3)
dat[!is.na(swst), swst_rev := ifelse(swst == 1, 0, 1)]
ggplot(dat[!is.na(swst_rev) & !is.na(mov_avg_reward_8C)], aes(x = moving_average_cat, y = swst_rev)) +
stat_summary()+
ggtheme +
labs(x = "Average Reward Rate", y = "% Stay trial", color = "")
figure_path = "/Users/alexandradecker/Dropbox/Projects_postdoc/INSIDE_SES/gambling/figures/"
ggsave("swst_moving_average.png", path = figure_path, width = 3, height = 3)
summaryh(glmer(swst ~ mov_avg_reward_8C * prev_trial_cardEC * Avg_SES + (mov_avg_reward_8C|Subject), family = "binomial", control = glmerControl(optimizer="bobyqa"), data = dat[prev_trial_card %in% c("win", "lose")]))
summaryh(glmer(swst ~ mov_avg_reward_8C * prev_trial_cardEC * Avg_SES_testC + (mov_avg_reward_8C|Subject), family = "binomial", control = glmerControl(optimizer="bobyqa"), data = dat[prev_trial_card %in% c("win", "lose")]))
income <- fread("../data_clean/income_dat.csv")
dat$Subject
income$subject
income$participant_ID
dat$Subject
income$participant_ID
left_join(dat, income[, .(Subject=participant_ID, Log_Income)])
dat <- left_join(dat, income[, .(Subject=participant_ID, Log_Income)])
summaryh(glmer(swst ~ mov_avg_reward_8C * prev_trial_cardEC * Log_Income + (mov_avg_reward_8C|Subject), family = "binomial", control = glmerControl(optimizer="bobyqa"), data = dat[prev_trial_card %in% c("win", "lose")]))
summaryh(glmer(swst ~  prev_trial_cardEC * Log_Income + (mov_avg_reward_8C|Subject), family = "binomial", control = glmerControl(optimizer="bobyqa"), data = dat[prev_trial_card %in% c("win", "lose")]))
summaryh(glmer(swst ~  prev_trial_cardEC * Log_Income + (prev_trial_cardEC|Subject), family = "binomial", control = glmerControl(optimizer="bobyqa"), data = dat[prev_trial_card %in% c("win", "lose")]))
library(data.table)
dt <- fread("/Users/alexandradecker/Downloads/CLEAN_ABCD_5.1_panel_20241022.csv")
glimpse(dt)
dt
library(data.table); library(dtplyr)
glimpse(dt)
??glimpse
library(data.table); library(dtplyr); library(dplyr)
glimpse(dt)
